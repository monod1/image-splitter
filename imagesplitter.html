<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Image Splitter Preview</title>
  <style>
    body { font-family: sans-serif; text-align: center; margin: 20px; }
    canvas { border: 1px solid #ccc; margin-top: 20px; max-width: 100%; }
  </style>
</head>
<body>
  <h1>Image Splitter Preview (3x3 A4 Grid)</h1>
  <input type="file" id="upload" accept="image/*">
  <br><br>
  <label>Scale: <input type="range" id="scale" min="10" max="200" value="100"> <span id="scaleVal">100%</span></label>
  <br>
  <canvas id="canvas"></canvas>

  <script>
    const upload = document.getElementById("upload");
    const scaleSlider = document.getElementById("scale");
    const scaleVal = document.getElementById("scaleVal");
    const canvas = document.getElementById("canvas");
    const ctx = canvas.getContext("2d");

    let img = null;
    let scale = 100;
    const cols = 3, rows = 3;

    upload.addEventListener("change", e => {
      const file = e.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = ev => {
        img = new Image();
        img.onload = () => draw();
        img.src = ev.target.result;
      };
      reader.readAsDataURL(file);
    });

    scaleSlider.addEventListener("input", e => {
      scale = e.target.value;
      scaleVal.textContent = scale + "%";
      draw();
    });

    function draw() {
      if (!img) return;
      const scaledW = img.width * scale / 100;
      const scaledH = img.height * scale / 100;
      canvas.width = scaledW;
      canvas.height = scaledH;

      ctx.clearRect(0, 0, scaledW, scaledH);
      ctx.drawImage(img, 0, 0, scaledW, scaledH);

      // Draw grid
      const cellW = scaledW / cols;
      const cellH = scaledH / rows;
      ctx.strokeStyle = "red";
      for (let i = 1; i < cols; i++) {
        ctx.beginPath();
        ctx.moveTo(i * cellW, 0);
        ctx.lineTo(i * cellW, scaledH);
        ctx.stroke();
      }
      for (let j = 1; j < rows; j++) {
        ctx.beginPath();
        ctx.moveTo(0, j * cellH);
        ctx.lineTo(scaledW, j * cellH);
        ctx.stroke();
      }
    }
  </script>
</body>
</html>
